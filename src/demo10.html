<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>canvas demo-10</title>
    <style>
        html, body {
            background: #ddd;
        }
        canvas {
            background: #FFF;
            cursor: crosshair;
        }
        #rubberbandDiv {
            position: absolute;
            display: none;
            border: 2px yellow solid;
            cursor: crosshair;            
        }
    </style>
</head>
<body>
    <h1>橡皮筋式选取</h1>
    
    <div id="rubberbandDiv"></div>
    <div>
        <button onclick="resetCanvas()">reset</button>
    </div>
    <canvas id="myCanvas" width="520" height="390"></canvas>

<script>

    var canvas = document.getElementById('myCanvas'),
        ctx = canvas.getContext('2d'),
        rubberbandDiv = document.getElementById('rubberbandDiv'),
        mouseDown = {},
        rubberbandRectangle = {}
        dragging = false;

    var imgData = 'data:image/jpg;base64,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';

    var imgElem = new Image();

    imgElem.src = imgData;

    imgElem.onload = function() {
        ctx.drawImage(imgElem, 0, 0, canvas.width, canvas.height);
    }

    // Functions
    function rubberbandStart(x, y) {
        mouseDown.x = x;
        mouseDown.y = y;

        rubberbandRectangle.left = x;
        rubberbandRectangle.top = y;

        dragging = true;

        showRubberbandDiv();
    }

    function rubberbandStretch(x, y) {
        // rubberbandRectangle
        var bbox = canvas.getBoundingClientRect();

        rubberbandRectangle.left = x < mouseDown.x ? x : mouseDown.x;
        rubberbandRectangle.top = y < mouseDown.y ? y : mouseDown.y;

        rubberbandRectangle.width = Math.abs(x - mouseDown.x);
        rubberbandRectangle.height = Math.abs(y - mouseDown.y);

        moveRubberbandDiv();
        resizeRubberbandDiv();
    }

    function rubberbandEnd() {
        var bbox = canvas.getBoundingClientRect();

        try {
            ctx.drawImage(canvas, rubberbandRectangle.left - bbox.left, rubberbandRectangle.top - bbox.top, 
                rubberbandRectangle.width, rubberbandRectangle.height, 0, 0, canvas.width, canvas.height);
        
        } catch (error) {
            
        }

        resetRubberbandRectangle();

        hideRubberbandDiv();
        moveRubberbandDiv();
        resizeRubberbandDiv();

        dragging = false;
    }

    function moveRubberbandDiv() {
        rubberbandDiv.style.left = rubberbandRectangle.left + 'px';
        rubberbandDiv.style.top = rubberbandRectangle.top + 'px';
    }

    function resizeRubberbandDiv() {
        rubberbandDiv.style.width = rubberbandRectangle.width + 'px';
        rubberbandDiv.style.height = rubberbandRectangle.height + 'px';
    }

    function showRubberbandDiv() {
        rubberbandDiv.style.display = 'inline';
    }

    function hideRubberbandDiv() {
        rubberbandDiv.style.display = 'none';
    }

    function resetRubberbandRectangle() {
        rubberbandRectangle.left = 0;
        rubberbandRectangle.top = 0;
        rubberbandRectangle.width = 0;
        rubberbandRectangle.height = 0;
    }

    function resetCanvas() {
        ctx.drawImage(imgElem, 0, 0, canvas.width, canvas.height);        
    }

    canvas.onmousedown = function(e) {
        e.preventDefault();
        rubberbandStart(e.clientX, e.clientY);
    }

    window.onmousemove = function(e) {
        e.preventDefault();        
        if (dragging) {
            rubberbandStretch(e.clientX, e.clientY);
        }
    }

    window.onmouseup = function(e) {
        e.preventDefault();        
        rubberbandEnd();
    }

</script>
</body>
</html>